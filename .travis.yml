---
#
# Ansible managed
#
language: python

python:
  - "3.8"

services:
  - docker

env:
  global:
    namespace="robertdebock"
  matrix:
    - image="amazonlinux" tag="1"
    - image="centos" tag="7"
    - image="centos" tag="latest"
    - image="debian" tag="latest"
    - image="debian" tag="bullseye"
    - image="fedora" tag="31"
    - image="fedora" tag="latest"
    - image="ubuntu" tag="latest"
    - image="ubuntu" tag="bionic"

cache:
  - pip

install:
  - pip install --upgrade pip
  - pip install tox

script:
  - function retry { counter=0 ; until "$@" ; do exit=$? ; counter=$(($counter + 1)) ; if [ $counter -ge 3 ] ; then return $exit ; fi ; done ; return 0; } ; retry tox --parallel all

notifications:
  webhooks: https://galaxy.ansible.com/api/v1/notifications/
  slack: "jP4sE2uBs+37pVQs6Tum9cBEMknEQV26OjmAJ/XG5ln/vrz6wxdCPezscu1VGRHvKRp47yRqwzE1YWdXewKKwAUwr+YB5D3R53+lR/r3pC1iG0ZX71rPa5Z+4W8sbYIFbMo1gHVCAM2RqsS5xE2mpsmJAg5pmRqbw8fL0sHRLo4dXv/VZOtR4uxi71wmuJ14sTHOibRe6zMt6OU/Ymixd8VNtBBEGeHcVDfquaELh24QslPA7XUFpu4EeBa+CuBfAlRc+1M+4YdXzaWqZSEchnatHfdQu7ykFPvh0dNhJFxcNAeQ4Az3zi/nZq+JBdxKN4ZjrGaITF1gbcBxVnD4r/2Ag6XN6LyAn2XhoPYa3EtEIl3tjsRkgJC1imoZP6VUY6Xzoy8MPQAfViW3xFZytSVDHkUDDJXIzryIRM4ydAOTn02DwJPXmpKEjXpKu8euXRt79lrrlm9s1YDmwxgpmLNoJTP2eu9U58BvghZnAKsYpdWcshi9yZHultLnzA/lIbR6RtZpUz4U4U/zmXZZMMGDEB3M1VNkqo9Sds+HlcCSkyNe3RmZzTFMCuNYUGUu9zVKTciXOddcMxrPzzxem0PM5UzgPbHf5O8e+RkWehWjA7Ezftzx8+BidMIOPUb4LpOclJIZIEbf6QBD5Co53Y9YxkbHsAms5QHRH9vCXIs="
  email: false
